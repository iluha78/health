# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ "Out of range value for column 'chol'"

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞

```
SQLSTATE[22003]: Numeric value out of range: 1264 
Out of range value for column 'chol' at row 1
```

## üîç –ü—Ä–∏—á–∏–Ω–∞

–¢–∏–ø –¥–∞–Ω–Ω—ã—Ö `DECIMAL(4,2)` –≤ —Ç–∞–±–ª–∏—Ü–µ `lipids` –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∑–Ω–∞—á–µ–Ω–∏—è –¥–æ **99.99**.

–ù–æ –ª–∏–ø–∏–¥–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å –º–æ–∂–µ—Ç –∏–∑–º–µ—Ä—è—Ç—å—Å—è –≤:
- **–º–º–æ–ª—å/–ª** (–ï–≤—Ä–æ–ø–∞, –†–æ—Å—Å–∏—è): 3.0 - 10.0
- **–º–≥/–¥–ª** (–°–®–ê): 100 - 300+

–í–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –≤ –º–≥/–¥–ª (–Ω–∞–ø—Ä–∏–º–µ—Ä, 120), –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –≤–º–µ—â–∞—é—Ç—Å—è –≤ `DECIMAL(4,2)`.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

–ò–∑–º–µ–Ω–∏—Ç—å —Ç–∏–ø –Ω–∞ `DECIMAL(6,2)` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∑–Ω–∞—á–µ–Ω–∏–π –¥–æ **9999.99**.

## üöÄ –ë—ã—Å—Ç—Ä–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
cp backend_migrations_005_fix_lipids_range.sql backend/migrations/005_fix_lipids_range.sql

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å
cd backend
composer migrate
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –í—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ SQL

```bash
mysql -u root -p cholestofit
```

```sql
ALTER TABLE lipids
  MODIFY COLUMN chol DECIMAL(6,2),
  MODIFY COLUMN hdl DECIMAL(6,2),
  MODIFY COLUMN ldl DECIMAL(6,2),
  MODIFY COLUMN trig DECIMAL(6,2);
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: Docker

```bash
# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
cp backend_migrations_005_fix_lipids_range.sql backend/migrations/005_fix_lipids_range.sql

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å backend (–º–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
docker-compose restart backend
```

## üìä –î–æ –∏ –ø–æ—Å–ª–µ

### –î–û (DECIMAL(4,2))
```
–î–∏–∞–ø–∞–∑–æ–Ω: -99.99 –¥–æ 99.99
‚ùå 120 ‚Üí ERROR
‚ùå 240 ‚Üí ERROR
‚úÖ 5.2 ‚Üí OK
‚úÖ 7.8 ‚Üí OK
```

### –ü–û–°–õ–ï (DECIMAL(6,2))
```
–î–∏–∞–ø–∞–∑–æ–Ω: -9999.99 –¥–æ 9999.99
‚úÖ 120 ‚Üí OK
‚úÖ 240 ‚Üí OK
‚úÖ 5.2 ‚Üí OK
‚úÖ 7.8 ‚Üí OK
```

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—ã
mysql -u root -p cholestofit -e "DESCRIBE lipids;"
```

–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
```
+----------+--------------+------+-----+---------+----------------+
| Field    | Type         | Null | Key | Default | Extra          |
+----------+--------------+------+-----+---------+----------------+
| id       | int          | NO   | PRI | NULL    | auto_increment |
| user_id  | int          | NO   | MUL | NULL    |                |
| dt       | date         | NO   |     | NULL    |                |
| chol     | decimal(6,2) | YES  |     | NULL    |                |  ‚Üê –ò–∑–º–µ–Ω–µ–Ω–æ!
| hdl      | decimal(6,2) | YES  |     | NULL    |                |  ‚Üê –ò–∑–º–µ–Ω–µ–Ω–æ!
| ldl      | decimal(6,2) | YES  |     | NULL    |                |  ‚Üê –ò–∑–º–µ–Ω–µ–Ω–æ!
| trig     | decimal(6,2) | YES  |     | NULL    |                |  ‚Üê –ò–∑–º–µ–Ω–µ–Ω–æ!
| note     | varchar(255) | YES  |     | NULL    |                |
+----------+--------------+------+-----+---------+----------------+
```

## üß™ –¢–µ—Å—Ç –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

```bash
# –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å —Å –±–æ–ª—å—à–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ–º
curl -X POST http://localhost:8080/lipids \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "dt": "2025-11-07",
    "chol": 220,
    "hdl": 45,
    "ldl": 140,
    "trig": 150
  }'
```

–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å —É—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç (201 Created).

## üåç –°–∏—Å—Ç–µ–º—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è

### –º–º–æ–ª—å/–ª ‚Üí –º–≥/–¥–ª (–∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è)

```
–û–±—â–∏–π —Ö–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω: –º–º–æ–ª—å/–ª √ó 38.67 = –º–≥/–¥–ª
HDL/LDL:          –º–º–æ–ª—å/–ª √ó 38.67 = –º–≥/–¥–ª
–¢—Ä–∏–≥–ª–∏—Ü–µ—Ä–∏–¥—ã:     –º–º–æ–ª—å/–ª √ó 88.57 = –º–≥/–¥–ª
```

### –ü—Ä–∏–º–µ—Ä—ã:

| –ü–æ–∫–∞–∑–∞—Ç–µ–ª—å | –º–º–æ–ª—å/–ª | –º–≥/–¥–ª |
|------------|---------|-------|
| –•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω | 5.2     | 201   |
| HDL        | 1.5     | 58    |
| LDL        | 3.0     | 116   |
| –¢—Ä–∏–≥–ª–∏—Ü–µ—Ä–∏–¥—ã | 1.7   | 151   |

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –¥–ª—è frontend

–ï—Å–ª–∏ –≤–∞—à frontend –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–∞–∑–Ω—ã–µ –µ–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è, –¥–æ–±–∞–≤—å—Ç–µ –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä:

```typescript
// –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –º–º–æ–ª—å/–ª ‚Üí –º–≥/–¥–ª
function mmolToMgDl(value: number, isTriglycerides = false): number {
  const factor = isTriglycerides ? 88.57 : 38.67;
  return Math.round(value * factor);
}

// –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –º–≥/–¥–ª ‚Üí –º–º–æ–ª—å/–ª
function mgDlToMmol(value: number, isTriglycerides = false): number {
  const factor = isTriglycerides ? 88.57 : 38.67;
  return Number((value / factor).toFixed(2));
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
const cholMgDl = 220;
const cholMmol = mgDlToMmol(cholMgDl); // 5.69
```

## üîÑ –ï—Å–ª–∏ –º–∏–≥—Ä–∞—Ü–∏—è —É–∂–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–µ–∫—É—â—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É:

```bash
mysql -u root -p cholestofit -e "SHOW COLUMNS FROM lipids LIKE 'chol';"
```

–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ `decimal(4,2)`, –ø—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é.  
–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ `decimal(6,2)`, –≤—Å—ë —É–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ.

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

- –≠—Ç–∞ –º–∏–≥—Ä–∞—Ü–∏—è **–±–µ–∑–æ–ø–∞—Å–Ω–∞** –∏ –Ω–µ —É–¥–∞–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ
- –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏ —Å –º–∞–ª—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 5.2 –º–º–æ–ª—å/–ª) –æ—Å—Ç–∞–Ω—É—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—ã —Å–º–æ–∂–µ—Ç–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –≤ –ª—é–±–æ–π —Å–∏—Å—Ç–µ–º–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è

## üìû –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –æ—Å—Ç–∞–µ—Ç—Å—è

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –º–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω–∏–ª–∞—Å—å: `DESCRIBE lipids`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker-compose logs backend` –∏–ª–∏ `tail -f backend/logs/error.log`
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ backend: `docker-compose restart backend`
4. –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à composer: `cd backend && composer dump-autoload`

## ‚úÖ –ì–æ—Ç–æ–≤–æ!

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏ –æ—à–∏–±–∫–∞ –∏—Å—á–µ–∑–Ω–µ—Ç –∏ –≤—ã —Å–º–æ–∂–µ—Ç–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –ª—é–±—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ª–∏–ø–∏–¥–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è.
